
{% macro community_comment(comment) %}

    <div class="flex flex-col justify-stretch items-stretch">
        <div
            class="
                px-[1em] [@media(min-width:480px)]:px-[2em] py-[0.5em] w-[100%]
                transition-all duration-[200ms]
            "
        >
            <section class="w-[100%] flex flex-row justify-start items-center gap-[0.5em]">
                <a
                    href="{{ url_for('library') }}"
                    class="
                        text-white h-[2rem] aspect-[1/1] rounded-[50%]
                    "
                    style="
                        background-image: url('{{ url_for('assets', path='library.png') }}');
                        background-size: 75%;
                        background-position: center;
                        background-repeat: no-repeat;
                    "
                >
                </a>
                <span class="text-white text-[0.75rem] font-bold">{{ comment.first_name }} {{ comment.last_name }}</span>
                <span class="text-gray-500 text-[0.75rem]">2025/05/16 23:34:09</span>
            </section>
            <section class="flex flex-row justify-stretch items-stretch gap-[0.5em]">
                <div
                    class="relative w-[2em] my-[0.25em] flex justify-stretch items-stretch rounded-[1em]"
                    onmouseover="
                        this.querySelector('.comment-highlighter').style.backgroundColor = 'oklch(55.1% 0.027 264.364)';
                    "
                    onmouseout="
                        this.querySelector('.comment-highlighter').style.backgroundColor = 'oklch(27.9% 0.041 260.031)';
                    "
                >
                    <div class="flex-1 h-full"></div>
                    <div class="comment-highlighter w-[0.5px] h-full bg-slate-800"></div>
                    <div class="flex-1 h-full"></div>
                </div>
                <div class="flex-1 {% if comment.depth == 2 %}mb-[1em]{% endif %}">
                    <article
                        class="
                            text-sm text-gray-400 font-sans break-words text-wrap
                        "
                    >{{ comment.content }}</article>
                    <section class="mt-[0.5em] w-[100%] flex flex-row justify-start items-center gap-[1em]">
                        {{ post_reaction_button(
                            reaction_name='like',
                            icon_path='like.png',
                            icon_coordinates=('50%', '40%'),
                            reaction_value=comment.likes
                        ) }}
                        {{ post_reaction_button(
                            reaction_name='dislike',
                            icon_path='dislike.png',
                            icon_coordinates=('50%', '75%'),
                            reaction_value=comment.dislikes
                        ) }}
                    </section>
                </div>
            </section>

            {% if comment.depth == 2 %}
                <span class="ml-[2.5em] text-blue-700 hover:underline hover:text-blue-500 hover:cursor-pointer">Open replies...</span>
            {% endif %}
            
            {% if comment.depth == 0 %}
            <a
                class="
                    mx-[3em] mt-[0.5em] py-[0.25em] px-[2em] w-[12em]
                    rounded-[1rem] flex flex-row justify-center items-center
                    bg-gray-800 text-white text-xs font-sans font-bold transition-all
                    duration-[100ms] hover:bg-gray-500 hover:bg-opacity-25 active:scale-[0.95]
                "
                href='/communities/analytics/post_id/comments/comment_id/thread/2'
            >
                View full thread
            </a>
            {% endif %}
        </div>

        {% if comment.replies and comment.depth < 2 %}
            {# reply area #}
            <div class="flex-1 flex flex-row justify-stretch items-stretch">
                <div class="relative w-[1.5em] [@media(min-width:480px)]:w-[2.5em] text-white flex flex-col justify-start items-end"></div>

                {# replies go here #}
                <div class="flex-1">
                    {# Same Comment Structure #}
                    {% for reply in comment.replies %}
                        {{ community_comment(reply) }}
                    {% endfor %}
                    {# end Comment Structure #}
                </div>
            </div>
        {% endif %}

    </div>
{% endmacro %}

