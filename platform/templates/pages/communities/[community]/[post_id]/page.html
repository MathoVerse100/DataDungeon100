{% extends "pages/communities/community_layout.html" %}
{% from "components/post_reaction_button.jinja" import post_reaction_button with context %}
{% from "components/dropdown.jinja" import dropdown with context %}


{% from "pages/communities/community_aside.html" import community_aside with context %}


{% block title %}Dungeon - Communities{% endblock %}

{% block scripts %}
    <script>document.title = 'Dungeon - Communities'</script>
    <script src="{{ url_for('static', path='js/dropdown.js') }}" defer></script>
{% endblock %}

    {% set community_post = {
        'user_info': {
            'user_profile_link': 'library',
            'user_profile_picture': 'explore.png',
            'user_name': "User's Name",
            'user_nickname': "User's Nickname",
        },
        'post_info': {
            'title': "Show that, for all positive integers N, sqrt(N) is an integer or an irrational number. How do I prove this?",
            'tags': [
                {
                    "name": "Mathematics",
                    "color": "oklch(68.1% 0.162 75.834)",
                },
                {
                    "name": "Physics",
                    "color": "red",
                },
                {
                    "name": "Computer Science",
                    "color": "purple",
                },
            ],
            'content': """
Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. 
        
In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. 
        
In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.
Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. 
        
In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. 
        
In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.
Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. 
        
In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. 
        
In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.
Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. 
        
In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. 
        
In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos. Coobla Coobla dee!""",
        },
        'post_metadata': {
            'likes': '12.2k',
            'dislikes': '304',
        }
    } %}

{% block main_body_main_content %}

    {% for _ in range(1) %}
        <div
            class="
                px-[1em] [@media(min-width:480px)]:px-[2em] py-[1em] w-[100%]
                transition-all duration-[200ms] hover:cursor-pointer hover:bg-gray-900 hover:bg-opacity-25
                border-b-[1px] border-b-gray-800
            "
        >
            <section class="w-[100%] flex flex-row justify-start items-center gap-[0.5em]">
                <a
                    href="{{ url_for(community_post['user_info']['user_profile_link']) }}"
                    class="
                        text-white h-[3rem] aspect-[1/1] rounded-[50%]
                    "
                    style="
                        background-image: url('{{ url_for('assets', path=community_post['user_info']['user_profile_picture']) }}');
                        background-size: cover;
                        background-position: center;
                        background-repeat: no-repeat;
                    "
                >
                </a>
                <div class="flex-1 flex flex-col justify-start items-start">
                    <span class="text-white text-[1rem] font-bold">{{ community_post['user_info']['user_name'] }}</span>
                    <span class="text-gray-400 text-[0.75rem] font-bold font-[cursive]"><span>Community:</span> <span class="px-[0.75em] bg-blue-500 rounded-[1rem] text-white -translate-y-[25%]">Analytics</span></span>
                </div>
            </section>
            <section class="py-[1em] flex flex-col justify-start items-start gap-[1em]">
                <header class="text-white font-bold text-lg sm:text-xl font-roboto">{{ community_post['post_info']['title'] }}</header>
                <div class="flex flex-row justify-start items-center gap-[1em] flex-wrap">
                    {% for tag in community_post['post_info']['tags'] %}
                        <span
                            class="
                                px-2 py-1 rounded-[1rem] text-white font-inter text-xs font-bold
                            "
                            style="
                                background-color: {{ tag['color'] }}
                            "
                        >
                            {{ tag['name'] }}
                        </span>
                    {% endfor %}
                </div>
                <pre
                    class="
                        text-sm text-gray-400 font-sans break-words text-wrap
                    "
                >{{ community_post['post_info']['content'] }}</pre>
            </section>
            <section class="w-[100%] flex flex-row justify-start items-center gap-[1em]">
                {{ post_reaction_button(
                    reaction_name='like',
                    icon_path='like.png',
                    icon_coordinates=('50%', '40%'),
                    reaction_value=community_post['post_metadata']['likes']
                ) }}
                {{ post_reaction_button(
                    reaction_name='dislike',
                    icon_path='dislike.png',
                    icon_coordinates=('50%', '75%'),
                    reaction_value=community_post['post_metadata']['dislikes']
                ) }}
            </section>            
        </div>
    {% endfor %}

    {% block community_post_comment_section %}

    {{ dropdown(class_names='mx-[2em] mt-[2em]') }}

    {% for _ in range(3) %}

    <div>
        <div
            class="
                px-[1em] [@media(min-width:480px)]:px-[2em] py-[1em] w-[100%]
                transition-all duration-[200ms]
            "
        >
            <section class="w-[100%] flex flex-row justify-start items-center gap-[0.5em]">
                <a
                    href="{{ url_for(community_post['user_info']['user_profile_link']) }}"
                    class="
                        text-white h-[2rem] aspect-[1/1] rounded-[50%]
                    "
                    style="
                        background-image: url('{{ url_for('assets', path=community_post['user_info']['user_profile_picture']) }}');
                        background-size: cover;
                        background-position: center;
                        background-repeat: no-repeat;
                    "
                >
                </a>
                <span class="text-white text-[0.75rem] font-bold">{{ community_post['user_info']['user_name'] }}</span>
                <span class="text-gray-500 text-[0.75rem]">2025-05-16 at 23:34:09</span>
            </section>
            <section class="flex flex-row justify-stretch items-stretch gap-[1em]">
                <div
                    class="w-[1.5em] flex justify-stretch items-stretch rounded-[1em] hover:[&>.comment-highlighter]:bg-gray-500 active:[&>.comment-highlighter]:bg-gray-600"
                    onmouseover="this.querySelector('.comment-highlighter').style.backgroundColor = 'oklch(55.1% 0.027 264.364)'"
                    onmouseout="this.querySelector('.comment-highlighter').style.backgroundColor = 'oklch(27.9% 0.041 260.031)'"
                >
                    <div class="flex-1 h-full"></div>
                    <div class="comment-highlighter w-[1px] h-full bg-slate-800"></div>
                    <div class="flex-1 h-full"></div>
                </div>
                <div class="flex-1">
                    <pre
                        class="
                            text-sm text-gray-400 font-sans break-words text-wrap
                        "
                    >{{ community_post['post_info']['content'][:1000] }}</pre>
                    <section class="mt-[0.5em] w-[100%] flex flex-row justify-start items-center gap-[1em]">
                        {{ post_reaction_button(
                            reaction_name='like',
                            icon_path='like.png',
                            icon_coordinates=('50%', '40%'),
                            reaction_value=community_post['post_metadata']['likes']
                        ) }}
                        {{ post_reaction_button(
                            reaction_name='dislike',
                            icon_path='dislike.png',
                            icon_coordinates=('50%', '75%'),
                            reaction_value=community_post['post_metadata']['dislikes']
                        ) }}
                    </section>
                </div>
            </section>
        </div>
    </div>

    {% endfor %}

    <footer class="mt-[5em]">This is the footer</footer>

    {% endblock %}

{% endblock %}